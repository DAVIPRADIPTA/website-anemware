{# templates/web/doctor/verification.html #}
{% extends "web/doctor/_layout.html" %}
{% block title %}Upload Verifikasi{% endblock %}

{% block head_extra %}
<style>
  .form-card{
    border-radius:16px;
    border:1px solid var(--border);
    box-shadow:var(--shadow);
    background:var(--surface);
  }
  .form-card .card-header{
    background:transparent;
    border-bottom:1px solid var(--border);
    padding:16px 18px;
  }
  .form-card .card-body{ padding:18px; }
  .form-label{ font-weight:800; }
  .hint{ color:var(--muted); font-size:.9rem; margin-top:4px; }
  .preview{
    border:1px dashed var(--border);
    border-radius:14px;
    background:#fafafa;
    padding:12px;
    display:flex;
    justify-content:space-between;
    gap:12px;
    align-items:center;
  }
</style>
{% endblock %}

{% block content %}
  <div class="page-header">
    <div>
      <h2>Upload Verifikasi STR/SIP</h2>
      <p>Unggah dokumen untuk aktivasi fitur konsultasi dan artikel.</p>
    </div>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mb-3">
        {% for category, msg in messages %}
          <div class="alert alert-{{ category }} mb-2">{{ msg }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div class="card form-card">
    <div class="card-header d-flex align-items-center justify-content-between flex-wrap gap-2">
      <div class="d-flex align-items-center gap-2">
        <span class="badge text-bg-success" style="border-radius:999px;">
          <i class="bi bi-patch-check me-1"></i> Verifikasi
        </span>

        {% if doctor.is_verified %}
          <span class="badge bg-success" style="border-radius:999px;">
            <i class="bi bi-check2-circle me-1"></i> Sudah Terverifikasi
          </span>
        {% else %}
          <span class="badge bg-warning text-dark" style="border-radius:999px;">
            <i class="bi bi-hourglass-split me-1"></i> Menunggu
          </span>
        {% endif %}
      </div>

      <a href="{{ url_for('doctor.dashboard') }}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left me-1"></i>Kembali
      </a>
    </div>

    <div class="card-body">
      <form method="POST" enctype="multipart/form-data">
        <div class="mb-3">
          <label class="form-label">Dokumen STR/SIP</label>

          {% if doctor.verification_doc %}
            <div class="preview mb-2">
              <div>
                <div class="fw-bold">Dokumen saat ini</div>
                <div class="text-muted">/{{ doctor.verification_doc }}</div>
              </div>
              <a href="/{{ doctor.verification_doc }}" target="_blank" class="btn btn-outline-secondary btn-sm">
                <i class="bi bi-file-earmark-text me-1"></i>Lihat
              </a>
            </div>
          {% else %}
            <div class="preview mb-2">
              <div>
                <div class="fw-bold">Belum ada dokumen</div>
                <div class="text-muted">Upload file STR/SIP untuk verifikasi.</div>
              </div>
            </div>
          {% endif %}

          <input type="file" name="verification_doc" class="form-control" accept=".jpg,.jpeg,.png,.pdf" required>
          <div class="hint">Format yang disarankan: PDF/JPG/PNG. Pastikan jelas terbaca.</div>
        </div>

        <button class="btn btn-success">
          <i class="bi bi-cloud-upload me-1"></i>Upload Dokumen
        </button>
      </form>
    </div>
  </div>
{% endblock %}
